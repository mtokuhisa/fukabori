# SharePoint配布ガイド - 深堀くん

## 🌐 SharePointでの配布方法

### ✅ 対応状況

**SharePoint Online（Microsoft 365）**
- ✅ **基本機能**: 完全対応
- ✅ **PWA機能**: 部分対応（Service Worker制限あり）
- ✅ **フォールバック**: 強力な代替機能実装済み

**SharePoint On-Premises**
- ✅ **全機能**: 完全対応
- ✅ **PWA機能**: 完全対応

### 📁 配布ファイル構成

```
深堀くん/
├── 深堀くん.html          # メインファイル
├── manifest.json          # PWAマニフェスト
├── sw.js                 # Service Worker
├── app/                  # アプリケーションファイル
│   ├── script.js
│   ├── style.css
│   └── ... (全28ファイル)
├── config/               # 設定ファイル
│   ├── app_settings.js
│   ├── prompts.js
│   └── ...
├── assets/               # 画像・アイコン
│   ├── fukabori_logo.png
│   └── ...
└── 画面キャプチャ/        # スクリーンショット
```

### 🚀 配布手順

#### Step 1: ファイルアップロード
1. SharePointサイトの「ドキュメント」ライブラリにアクセス
2. 「深堀くん」フォルダを作成
3. 全ファイルをフォルダ構造を保持してアップロード

#### Step 2: 権限設定
1. フォルダの権限を「読み取り専用」に設定
2. 対象ユーザー・グループに共有権限を付与

#### Step 3: アクセス方法の案内
```
https://[your-sharepoint-site]/深堀くん/深堀くん.html
```

### 🔧 SharePoint制限への対応

#### Service Worker制限
SharePoint Onlineでは、Service Workerが制限される場合があります。
アプリケーションは以下の方法で対応済みです：

**1. 自動フォールバック**
```javascript
// Service Worker登録失敗時の処理
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js')
        .catch(error => {
            console.log('Service Worker非対応環境 - 基本機能で動作');
            // フォールバック機能が自動実行
        });
}
```

**2. 強力なフォールバック機能**
- CSV設定ファイル読み込み失敗時の自動代替
- 外部CDN失敗時の代替処理
- オフライン機能なしでも完全動作

#### 外部リソース制限
SharePointの外部リソース制限に対応：

**1. 外部CDN**
- PDF.js、SheetJS等の動的読み込み
- 読み込み失敗時の自動フォールバック

**2. OpenAI API**
- 企業プロキシ経由でも動作
- API呼び出し失敗時の適切なエラーハンドリング

### 📱 PWA機能の動作

#### SharePoint Online
- ✅ **基本PWA**: マニフェスト読み込み、アイコン表示
- ⚠️ **Service Worker**: 制限される場合あり
- ✅ **インストール**: ブラウザの「インストール」ボタンで可能

#### SharePoint On-Premises
- ✅ **完全PWA**: 全機能対応
- ✅ **オフライン**: 完全対応
- ✅ **インストール**: 完全対応

### 🛡️ セキュリティ対応

#### 企業セキュリティポリシー
1. **外部API制限**
   - OpenAI API呼び出しの事前許可が必要
   - IT部門との調整が推奨

2. **マイク許可**
   - 初回使用時にブラウザ許可が必要
   - グループポリシーでの事前許可が推奨

3. **ファイルアップロード**
   - PDF/Excel/Word処理のセキュリティ確認
   - 機密情報の取り扱い注意

### 💡 配布時の注意点

#### 1. URLの統一
```
https://[company].sharepoint.com/sites/[site]/深堀くん/深堀くん.html
```

#### 2. ブックマーク推奨
ユーザーにブックマーク保存を推奨：
- デスクトップショートカット作成
- ブラウザお気に入り登録

#### 3. 初回セットアップ案内
1. OpenAI APIキーの設定
2. マイク許可の確認
3. 基本操作の説明

### 🔄 更新・メンテナンス

#### ファイル更新
1. 新しいファイルをアップロード
2. 古いファイルを削除
3. ユーザーにブラウザキャッシュクリアを案内

#### バージョン管理
- SharePointのバージョン履歴機能を活用
- 重要な更新前のバックアップ作成

### 📊 動作確認チェックリスト

#### 基本機能
- [ ] HTMLファイルの正常表示
- [ ] APIキー設定画面の動作
- [ ] マイク許可の取得
- [ ] 音声認識の動作
- [ ] ファイル処理の動作

#### PWA機能
- [ ] マニフェストファイルの読み込み
- [ ] アイコンの表示
- [ ] インストールボタンの表示
- [ ] Service Workerの登録（可能な場合）

#### セキュリティ
- [ ] 外部API呼び出しの成功
- [ ] ファイルアップロードの動作
- [ ] データ保存の確認

### 🆘 トラブルシューティング

#### よくある問題
1. **Service Worker登録失敗**
   - 正常：フォールバック機能で動作継続
   - 対応：特に対応不要

2. **外部CDN読み込み失敗**
   - 原因：企業ファイアウォール
   - 対応：IT部門に外部CDNアクセス許可を依頼

3. **OpenAI API呼び出し失敗**
   - 原因：プロキシ設定
   - 対応：IT部門にAPI許可を依頼

### 📞 サポート体制

#### ユーザーサポート
1. 初回セットアップ支援
2. 操作方法の説明
3. トラブル時の対応

#### IT部門連携
1. セキュリティポリシーの確認
2. 外部リソースアクセス許可
3. 企業プロキシ設定の調整

## 結論

SharePointでの配布は**完全に対応可能**です。強力なフォールバック機能により、制限がある環境でも安定動作します。 