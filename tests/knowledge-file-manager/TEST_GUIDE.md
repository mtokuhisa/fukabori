# 🧪 深堀くん - KnowledgeFileManager テストツール ガイド

## 📋 概要

このテストツールは、深堀くんのKnowledgeFileManagerリファクタリングが正常に動作するかを視覚的に確認できるWebベースのテストツールです。

## 🚀 使用方法

### 1. テストツールを開く

1. `test-knowledge-file-manager.html` をブラウザで開いてください
2. すべてのスクリプトが自動的に読み込まれます
3. 「テストツールが初期化されました」のメッセージが表示されれば準備完了です

### 2. テスト実行

#### 🚀 全テスト実行（推奨）
- **ボタン**: 「🚀 全テスト実行」
- **内容**: Phase 1テスト + 統合テスト + 後方互換性テスト
- **時間**: 約30秒-1分
- **推奨**: 初回実行時や全体的な動作確認時

#### 🔧 Phase 1テスト
- **ボタン**: 「🔧 Phase 1テスト」  
- **内容**: 依存関係インターフェース化のテスト
- **時間**: 約15-30秒
- **推奨**: Phase 1実装後の確認時

#### 🔗 統合テスト
- **ボタン**: 「🔗 統合テスト」
- **内容**: 実際のフロー（セッション作成→知見追加→ファイル生成）のテスト
- **時間**: 約15-30秒
- **推奨**: 実際の動作確認時

### 3. 結果の見方

#### ✅ 成功の場合
- **カード色**: 緑色の左ボーダー
- **ステータス**: 「✅ 成功」
- **意味**: そのテストが正常に完了

#### ❌ 失敗の場合
- **カード色**: 赤色の左ボーダー
- **ステータス**: 「❌ 失敗」
- **詳細**: エラー詳細が表示される
- **対応**: エラー内容を確認して修正が必要

#### 🔄 実行中の場合
- **カード色**: 青色の左ボーダー
- **ステータス**: 「🔄 実行中」
- **意味**: テストが実行中

## 📊 画面の説明

### ⚙️ テスト設定
- **テスト実行速度**: テストの実行速度を調整
- **ログレベル**: 表示するログの詳細レベル
- **自動スクロール**: テスト結果を自動でスクロール

### 📊 テスト進行状況
- **プログレスバー**: 現在のテスト進行状況
- **ステータステキスト**: 現在実行中の処理

### 📋 テスト結果
- **結果カード**: 各テストの詳細結果
- **実行時間**: 各テストの実行時間
- **エラー詳細**: 失敗した場合のエラー内容

### 🎯 テスト結果サマリー
- **総テスト数**: 実行されたテストの総数
- **成功**: 成功したテストの数
- **失敗**: 失敗したテストの数
- **実行時間**: 全体の実行時間

### 📝 テストログ
- **リアルタイムログ**: テスト実行中のログをリアルタイム表示
- **タイムスタンプ**: 各ログエントリの時刻
- **ログレベル**: INFO、SUCCESS、ERROR、WARNのレベル表示

## 🔧 トラブルシューティング

### ❓ テストが実行されない
1. ブラウザのコンソールでエラーが出ていないか確認
2. すべてのJSファイルが正常に読み込まれているか確認
3. インターネット接続を確認（CryptoJSライブラリの読み込み）

### ❓ テストが失敗する
1. **依存関係エラー**: 必要なファイルが不足している可能性
2. **API関連エラー**: APIキーが設定されていない（一部のテストはスキップされます）
3. **実装エラー**: コードに問題がある可能性

### ❓ 画面が正常に表示されない
1. ブラウザが対応しているか確認（Chrome、Firefox、Safari推奨）
2. JavaScriptが有効になっているか確認
3. ファイルが正常に読み込まれているか確認

## 📄 その他の機能

### 🗑️ 結果クリア
- テスト結果とログをクリアして新しいテストに備える

### 📄 結果エクスポート
- テスト結果をJSONファイルとしてダウンロード
- 結果の共有や記録保存に使用

### 📋 ログ管理・診断機能（新機能）

#### ログ管理ボタン
- **📋 全ログコピー**: 全てのログをクリップボードにコピー
- **❌ エラーログのみコピー**: エラーログのみを抽出してコピー
- **🗑️ ログクリア**: 表示されているログをクリア
- **💾 ログダウンロード**: ログをテキストファイルとしてダウンロード

#### 診断レポート機能
- **🔍 診断レポート**: システム情報とエラー分析を含む包括的なレポート生成
- **📋 診断レポートコピー**: 診断レポートをクリップボードにコピー
- **💾 診断レポートダウンロード**: 診断レポートをファイルとしてダウンロード
- **✕ 閉じる**: 診断レポートを閉じる

#### 診断レポートに含まれる情報
- **システム情報**: ブラウザ、OS、画面サイズ、メモリ等
- **テスト結果サマリー**: 成功/失敗数、実行時間
- **エラーログ**: 発生したエラーの詳細
- **警告ログ**: 発生した警告の詳細
- **全ログ履歴**: 時系列でのすべてのログ
- **推奨対処法**: 自動分析による問題解決のヒント

## 🎯 期待される結果

### 正常な場合
```
🎯 テスト結果サマリー
総テスト数: 7
成功: 7
失敗: 0
実行時間: 約500-1000ms
```

### 個別テストの内容
1. **セッション作成テスト**: KnowledgeFileManager.createSessionFile()の動作確認
2. **知見追加テスト**: KnowledgeFileManager.addInsight()の動作確認
3. **ファイル生成テスト**: KnowledgeFileManager.generateKnowledgeFile()の動作確認
4. **AI拡張テスト**: KnowledgeFileManager.enhanceKnowledgeWithAI()の動作確認
5. **空セッションエラーテスト**: エラーハンドリングの確認
6. **無効データエラーテスト**: エラーハンドリングの確認
7. **完全フローテスト**: 一連の処理の統合確認

## 📞 サポート

テストで問題が発生した場合は、新しい診断レポート機能を活用して効率的に問題を報告できます：

### 🔍 推奨手順
1. **診断レポート生成**: 「🔍 診断レポート」ボタンをクリック
2. **レポートコピー**: 「📋 診断レポートコピー」でレポートをコピー
3. **問題報告**: コピーしたレポートを開発者に共有

### 📋 手動でのサポート情報
診断レポートが利用できない場合は、以下の情報を含めてご連絡ください：

1. **ブラウザ情報**: 使用ブラウザとバージョン
2. **エラーログ**: 「❌ エラーログのみコピー」で取得したエラー内容
3. **実行環境**: 操作システムなど
4. **テスト結果**: 失敗したテストの詳細

### 💡 診断レポートの利点
- **包括的な情報**: システム情報、ログ、テスト結果を一括取得
- **自動分析**: 問題の原因と対処法を自動で分析・提案
- **効率的な共有**: ワンクリックでコピー・ダウンロード可能
- **時系列ログ**: 問題発生までの経緯を詳細に記録

---

**📝 注意**: このテストツールは開発・確認用です。実際の深堀くんの機能には影響しません。 