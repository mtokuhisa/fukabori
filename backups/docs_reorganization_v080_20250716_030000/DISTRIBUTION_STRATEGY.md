# 深堀くん配布戦略とリスク評価

## 現状分析

### CORS制限が発生する箇所
- `config/categories.csv` - カテゴリ設定ファイル
- `config/user_names.csv` - ユーザー設定ファイル
- 動的なCSVファイル読み込み（fetch API使用）

### 外部依存関係
- OpenAI API（必須）
- 外部CDN（SheetJS、PDF.js、Mammoth、JSZip、CryptoJS）

## 配布戦略オプション

### Option 1: スタンドアロン版（推奨）
**概要**: 全設定をJavaScriptに埋め込み、file://プロトコル対応

**実装方法**:
1. CSV設定をJSONとして埋め込み
2. フォールバック機能を主機能に変更
3. 外部CDNの確実な読み込み保証

**メリット**:
- ✅ ダブルクリックで起動
- ✅ USBドライブ配布可能
- ✅ 企業環境での動作保証
- ✅ 技術知識不要

**デメリット**:
- ❌ 設定変更時の再ビルド必要
- ❌ ファイルサイズ増大

### Option 2: ローカルサーバー版（現在）
**概要**: 現在の実装を維持

**メリット**:
- ✅ 設定ファイルの分離管理
- ✅ 開発・保守性

**デメリット**:
- ❌ 企業環境での動作リスク
- ❌ ユーザビリティ問題
- ❌ サポートコスト

### Option 3: パッケージ化版
**概要**: Electron/PWA/exe化

**メリット**:
- ✅ ネイティブアプリ体験
- ✅ 配布の簡易性

**デメリット**:
- ❌ 開発コスト大
- ❌ 複数プラットフォーム対応
- ❌ 企業セキュリティ制約

## リスク評価

### 🔴 高リスク：社内環境での動作不可
1. **企業ファイアウォール**
   - ローカルサーバーポートブロック
   - 外部CDNアクセス制限
   - OpenAI APIアクセス制限

2. **権限制約**
   - サーバー起動権限なし
   - ポート使用制限
   - 実行ファイル制限

3. **技術的制約**
   - Python環境なし
   - コマンドライン使用不可
   - IT部門のセキュリティポリシー

### 🟡 中リスク：設定・運用問題
1. **ユーザビリティ**
   - 起動手順の複雑さ
   - エラー時の対応困難
   - サポートコスト増大

2. **互換性**
   - ブラウザ制限
   - OS依存性
   - 環境差異

## 推奨アクション

### 即座に実施すべき対策
1. **スタンドアロン版の作成**
   - CSV設定のJavaScript埋め込み
   - フォールバック機能の強化
   - file://プロトコル対応

2. **デュアル配布**
   - 開発者向け：ローカルサーバー版
   - エンドユーザー向け：スタンドアロン版

3. **企業環境テスト**
   - 実際の企業環境での動作確認
   - IT部門との事前調整
   - セキュリティ要件の確認

### 長期的な対策
1. **PWA化**
   - オフライン対応
   - インストール可能
   - 企業配布対応

2. **設定管理の改善**
   - 動的設定変更UI
   - 設定エクスポート/インポート
   - 環境別設定管理

## 結論

**最優先**: スタンドアロン版の作成により、企業環境での動作不可リスクを完全に排除する。
現在のローカルサーバー版は開発・保守用として維持し、エンドユーザーには確実に動作するスタンドアロン版を提供する。 